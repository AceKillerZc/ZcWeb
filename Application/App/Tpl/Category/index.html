    <import type="css" file="css.category.right,css.category.form"/>
    <import type="js" file="js.core.jquery" />
    <div id="content">
        <div class="content-top"><a href="__URL__/index">分类管理</a></div>
        <div class="section-div">分类列表:(分类名称20个字限制)</div>
        <div class="section-div">
            <form action="__URL__/add" id="form1" method="post">
            <volist name="result" id="result">
                
  
                    <if condition="$result.pid eq 0">
                        <div class="top_{$result.id} category">
                            <div><a href="javascript:;" onclick="topshow('top_{$result.id}',this)">★</a></div>
                            <div><input type="text" value="{$result.name}" id="top_{$result.id}" /></div>
                            <div><a href="javascript:;" onclick="add('{$result.id}')">@添加子类</a>&nbsp;&nbsp;&nbsp;<a href="javascript:;" onclick="edit('{$result.id}')">@提交编辑</a>&nbsp;&nbsp;&nbsp;<a href="#" onclick="del('{$result.id}')">删除分类</a></div>
                        </div>
                    <else />
                    <div class="top_{$result.pid}_child category" style="display:block;">
                        <span>————————<input type="text" name="" value="{$result.name}" id="top_{$result.id}"/></span>
                            <span><a href="javascript:;" onclick="edit('{$result.id}')">@提交编辑</a>&nbsp;&nbsp;&nbsp;<a href="#" onclick="del('{$result.id}')">删除分类</a></span>
                        </div>
                    </if>
                 
                </volist>
                <div onclick="addtop(this)"><a href="javascript:;" >@添加顶级分类</a></div>
                <div onclick="sub()"><a href="javascript:;">@提交数据</a></div>
                </form>
		</div>
    </div>
    <script>
        function add(obj){
            
             var $a=$(obj);
             var form='<div class="top_'+obj+'_child" style="display:block;">输入分类名称：<input type="text" name="child'+obj+'[]" value="" /><a href="#" onclick="$(this).parent().hide()">【CLOSE】</a></div>';
            
            $(form).insertAfter($('.top_'+obj));
        
        }

        function topshow(obj1,obj2){
            
            if($('.'+obj1+'_child')[0].style.display=='block'){
                $('.'+obj1+'_child').css('display','none');
            }else{
                $('.'+obj1+'_child').css('display','block');
            }
            if(obj2.innerHTML=='★'){
                obj2.innerHTML='☆';
            }else{
                obj2.innerHTML='★';
            }
        }

        function addtop(obj){
            var $a=$(obj);
            var form='<div class="jsform" style="display:block;">输入顶级分类名称：<input type="text" name="top[]" value="" /></div>';
            $(form).insertBefore($a);
        }

        function sub()
        {
            $('#form1').submit();
        
        }
        function del(obj)
        {
            if(confirm('确定吗')){
                location.href='__URL__/del/id/'+obj;
            }
        }

        function edit(obj)
        {
            var data=$('#top_'+obj).val();
            window.location='__URL__/edit/data/'+data+'/id/'+obj;
        }
    </script>